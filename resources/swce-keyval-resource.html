<!DOCTYPE html>
<html lang="en">
<head>
    
    <title>Duty Free - Key Value resource</title>

    <link rel="stylesheet" type="text/css" href="/dutyfree/static/style.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
</head>
<body>
<div class="container">
    <div class="logo-area">
        <div class="title">
            <h1>CONCOURSE DUTY FREE</h1>
        </div>
    </div>


    <div class="search">
         
    </div>

    <nav class="sidebar">
         
    </nav>

    <main class="content">

        <div class="breadcrumb">
        
        
            
                    <span class="breadcrumb-link"><a href="/dutyfree">All Resources</a></span>
                
        
            
                    <span>Key Value resource</span>
            
        
        </div>

        
    <section class="top-area">
        <h2>Key Value resource</h2>
        <div>
            <a target="_blank" href="https://github.com/swce/keyval-resource">
                <img src="/dutyfree/static/GitHub-Mark-120px-plus.png" alt="Resource Source on Github"
                     class="github-icon-detail"
                     title="Resource Source on Github">
            </a>
            <a href="https://github.com/swce" target="_blank" class="author">swce</a>
        </div>
    </section>
    <section class="middle-area">
        <div class="description">
            <h3>Description</h3>
            <p class="desc">Implements a resource that passes key values between jobs without using any external resource such as git/s3 etc.</p>
        </div>
        
    </section>
    <section id="github-readme">
        <h3>Read Me</h3>
        <div id="readme" class="instapaper_body md" data-path="README.md"><article class="markdown-body entry-content p-5" itemprop="text"><p><a href="https://registry.hub.docker.com/v2/repositories/swce/keyval-resource/stars/count/" rel="nofollow"><img src="https://camo.githubusercontent.com/d6e17f2020030edc36c596aa57d59afc5371e133/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f73746172732f737763652f6b657976616c2d7265736f757263652e7376673f7374796c653d706c6173746963" alt="Docker Stars" data-canonical-src="https://img.shields.io/docker/stars/swce/keyval-resource.svg?style=plastic" style="max-width:100%;"></a>
<a href="https://registry.hub.docker.com/v2/repositories/swce/keyval-resource" rel="nofollow"><img src="https://camo.githubusercontent.com/88606fe01e565757035577ffa90c00e07e97a113/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f70756c6c732f737763652f6b657976616c2d7265736f757263652e7376673f7374796c653d706c6173746963" alt="Docker pulls" data-canonical-src="https://img.shields.io/docker/pulls/swce/keyval-resource.svg?style=plastic" style="max-width:100%;"></a>
<a href="https://github.com/swce/keyval-resource"><img src="https://camo.githubusercontent.com/b49b20f49e9f06c58542613d4b099dbf14c479f3/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f6275696c642f737763652f6b657976616c2d7265736f757263652e737667" alt="Docker build status" data-canonical-src="https://img.shields.io/docker/build/swce/keyval-resource.svg" style="max-width:100%;"></a>
<a href="https://github.com/swce/keyval-resource"><img src="https://camo.githubusercontent.com/0653839f0289ae6baeff9b040a48c5ce6ef38ee8/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f6175746f6d617465642f737763652f6b657976616c2d7265736f757263652e737667" alt="Docker Automated build" data-canonical-src="https://img.shields.io/docker/automated/swce/keyval-resource.svg" style="max-width:100%;"></a></p>
<p><a href="https://hub.docker.com/r/swce/keyval-resource/" rel="nofollow"><img src="https://camo.githubusercontent.com/8cd860522f2272a4f2d25124ffdab8fb729fa581/687474703a2f2f646f636b6572692e636f2f696d6167652f737763652f6b657976616c2d7265736f75726365" alt="dockeri.co" data-canonical-src="http://dockeri.co/image/swce/keyval-resource" style="max-width:100%;"></a></p>
<h1><a id="user-content-concourse-ci-key-value-resource" class="anchor" aria-hidden="true" href="#concourse-ci-key-value-resource"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Concourse CI Key Value Resource</h1>
<p>Implements a resource that passes key values between jobs without using any external resource such as git/s3 etc.</p>
<h2><a id="user-content-thanks" class="anchor" aria-hidden="true" href="#thanks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Thanks</h2>
<p>This resource was implemented based on the <a href="https://github.com/concourse/time-resource">time resource</a></p>
<h2><a id="user-content-source-configuration" class="anchor" aria-hidden="true" href="#source-configuration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Source Configuration</h2>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">resource_types</span>:
  - <span class="pl-ent">name</span>: <span class="pl-s">keyval</span>
    <span class="pl-ent">type</span>: <span class="pl-s">docker-image</span>
    <span class="pl-ent">source</span>:
      <span class="pl-ent">repository</span>: <span class="pl-s">swce/keyval-resource</span>
      
<span class="pl-ent">resources</span>:
  - <span class="pl-ent">name</span>: <span class="pl-s">keyval</span>
    <span class="pl-ent">type</span>: <span class="pl-s">keyval</span></pre></div>
<h4><a id="user-content-parameters" class="anchor" aria-hidden="true" href="#parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parameters</h4>
<p><em>None.</em></p>
<h2><a id="user-content-behavior" class="anchor" aria-hidden="true" href="#behavior"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Behavior</h2>
<h3><a id="user-content-check-produce-a-single-dummy-key" class="anchor" aria-hidden="true" href="#check-produce-a-single-dummy-key"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>check</code>: Produce a single dummy key</h3>
<p>This is a version-less resource so <code>check</code> behavior is no-op</p>
<h3><a id="user-content-in-report-the-given-time" class="anchor" aria-hidden="true" href="#in-report-the-given-time"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>in</code>: Report the given time.</h3>
<p>Fetches the given key values and stores them in the <code>keyval.properties</code> file.
The format is of a <code>.properties</code> file, e.g. <code>"&lt;key&gt;=&lt;value&gt;"</code>.</p>
<h4><a id="user-content-parameters-1" class="anchor" aria-hidden="true" href="#parameters-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parameters</h4>
<p><em>None.</em></p>
<h3><a id="user-content-out-consumes-the-given-properties-file" class="anchor" aria-hidden="true" href="#out-consumes-the-given-properties-file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>out</code>: Consumes the given properties file</h3>
<div class="highlight highlight-source-yaml"><pre>- <span class="pl-ent">put</span>: <span class="pl-s">keyval</span>
  <span class="pl-ent">params</span>:
    <span class="pl-ent">file</span>: <span class="pl-s">keyvalout/keyval.properties</span></pre></div>
<p>Reads the given properties file and sets them for the next job.</p>
<h4><a id="user-content-parameters-2" class="anchor" aria-hidden="true" href="#parameters-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parameters</h4>
<ul>
<li>file - the properties file to read the key values from</li>
</ul>
<h2><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h2>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">resource_types</span>:
  - <span class="pl-ent">name</span>: <span class="pl-s">keyval</span>
    <span class="pl-ent">type</span>: <span class="pl-s">docker-image</span>
    <span class="pl-ent">source</span>:
      <span class="pl-ent">repository</span>: <span class="pl-s">swce/keyval-resource</span>

<span class="pl-ent">resources</span>:
  - <span class="pl-ent">name</span>: <span class="pl-s">keyval</span>
    <span class="pl-ent">type</span>: <span class="pl-s">keyval</span>

<span class="pl-ent">jobs</span>:

  - <span class="pl-ent">name</span>: <span class="pl-s">build</span>
    <span class="pl-ent">plan</span>:
      - <span class="pl-ent">task</span>: <span class="pl-s">build</span>
        <span class="pl-ent">file</span>: <span class="pl-s">tools/tasks/build/task.yml</span>
      - <span class="pl-ent">put</span>: <span class="pl-s">keyval</span>
        <span class="pl-ent">params</span>:
          <span class="pl-ent">file</span>: <span class="pl-s">keyvalout/keyval.properties</span>

  - <span class="pl-ent">name</span>: <span class="pl-s">test-deploy</span>
    <span class="pl-ent">plan</span>:
      - <span class="pl-ent">aggregate</span>:
        - <span class="pl-ent">get</span>: <span class="pl-s">keyval</span>
          <span class="pl-ent">passed</span>:
          - <span class="pl-s">build</span>
      - <span class="pl-ent">task</span>: <span class="pl-s">test-deploy</span>
        <span class="pl-ent">file</span>: <span class="pl-s">tools/tasks/task.yml</span></pre></div>
<p>The build job writes all the key values it needs to pass along (e.g. artifact id) in the <code>keyvalout/keyval.properties</code> file.
The test-deploy can read the data from the <code>keyval/keyval.properties</code> file and use them as it pleases.</p>
<h2><a id="user-content-ci-suggestions" class="anchor" aria-hidden="true" href="#ci-suggestions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CI suggestions</h2>
<h3><a id="user-content-auto-export-the-keys" class="anchor" aria-hidden="true" href="#auto-export-the-keys"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Auto export the keys</h3>
<p>You can add the following bash script to the <strong>start</strong> of every job to auto export the passed key values, if they exist.
The script assumes that the resource folder is <code>keyval</code>.</p>
<ul>
<li>Don't forget to source the script so it's exports will be passed along</li>
</ul>
<div class="highlight highlight-source-shell"><pre><span class="pl-c"><span class="pl-c">#!</span>/bin/bash</span>

props=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${ROOT_FOLDER}</span>/keyval/keyval.properties<span class="pl-pds">"</span></span>
<span class="pl-k">if</span> [ <span class="pl-k">-f</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$props</span><span class="pl-pds">"</span></span> ]
<span class="pl-k">then</span>
  <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>Reading passed key values<span class="pl-pds">"</span></span>
  <span class="pl-k">while</span> IFS= <span class="pl-c1">read</span> -r var
  <span class="pl-k">do</span>
    <span class="pl-k">if</span> [ <span class="pl-k">!</span> <span class="pl-k">-z</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$var</span><span class="pl-pds">"</span></span> ]
    <span class="pl-k">then</span>
      <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>Adding: <span class="pl-smi">$var</span><span class="pl-pds">"</span></span>
      <span class="pl-k">export</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$var</span><span class="pl-pds">"</span></span>
    <span class="pl-k">fi</span>
  <span class="pl-k">done</span> <span class="pl-k">&lt;</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$props</span><span class="pl-pds">"</span></span>
<span class="pl-k">fi</span>
</pre></div>
<h3><a id="user-content-auto-pass-the-keys" class="anchor" aria-hidden="true" href="#auto-pass-the-keys"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Auto pass the keys</h3>
<p>You can add the following bash script to the <strong>end</strong> of every job to auto pass specific environment variables as key values to the next job.
The script only passes environment variables that start with <code>PASSED_</code>.
The script assumes that the resource out file is <code>keyvalout/keyval.properties</code>:</p>
<p>e.g.</p>
<div class="highlight highlight-source-yaml"><pre>- <span class="pl-ent">put</span>: <span class="pl-s">keyval</span>
  <span class="pl-ent">params</span>:
    <span class="pl-ent">file</span>: <span class="pl-s">keyvalout/keyval.properties</span></pre></div>
<div class="highlight highlight-source-shell"><pre><span class="pl-c"><span class="pl-c">#!</span>/bin/bash</span>

propsDir=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${ROOT_FOLDER}</span>/keyvalout<span class="pl-pds">"</span></span>
propsFile=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${propsDir}</span>/keyval.properties<span class="pl-pds">"</span></span>
<span class="pl-k">if</span> [ <span class="pl-k">-d</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$propsDir</span><span class="pl-pds">"</span></span> ]
<span class="pl-k">then</span>
  touch <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$propsFile</span><span class="pl-pds">"</span></span>
  <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>Setting key values for next job in <span class="pl-smi">${propsFile}</span><span class="pl-pds">"</span></span>
  <span class="pl-k">while</span> IFS=<span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span> <span class="pl-c1">read</span> -r name value <span class="pl-k">;</span> <span class="pl-k">do</span>
    <span class="pl-k">if</span> [[ <span class="pl-smi">$name</span> <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span>PASSED_<span class="pl-pds">'</span></span><span class="pl-k">*</span> ]]<span class="pl-k">;</span> <span class="pl-k">then</span>
      <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>Adding: <span class="pl-smi">${name}</span>=<span class="pl-smi">${value}</span><span class="pl-pds">"</span></span>
      <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${name}</span>=<span class="pl-smi">${value}</span><span class="pl-pds">"</span></span> <span class="pl-k">&gt;&gt;</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$propsFile</span><span class="pl-pds">"</span></span>
    <span class="pl-k">fi</span>
  <span class="pl-k">done</span> <span class="pl-k">&lt;</span> <span class="pl-s"><span class="pl-pds">&lt;(</span>env<span class="pl-pds">)</span></span>
<span class="pl-k">fi</span>
</pre></div>
<h2><a id="user-content-development" class="anchor" aria-hidden="true" href="#development"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Development</h2>
<h3><a id="user-content-prerequisites" class="anchor" aria-hidden="true" href="#prerequisites"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h3>
<ul>
<li>golang is <em>required</em> - version 1.9.x is tested; earlier versions may also
work.</li>
<li>docker is <em>required</em> - version 17.06.x is tested; earlier versions may also
work.</li>
<li>godep is used for dependency management of the golang packages.</li>
</ul>
<h3><a id="user-content-running-the-tests" class="anchor" aria-hidden="true" href="#running-the-tests"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Running the tests</h3>
<p>The tests have been embedded with the <code>Dockerfile</code>; ensuring that the testing
environment is consistent across any <code>docker</code> enabled platform. When the docker
image builds, the test are run inside the docker container, on failure they
will stop the build.</p>
<p>Run the tests with the following command:</p>
<div class="highlight highlight-source-shell"><pre>docker build -t keyval-resource <span class="pl-c1">.</span></pre></div>
<h3><a id="user-content-contributing" class="anchor" aria-hidden="true" href="#contributing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contributing</h3>
<p>Please make all pull requests to the <code>master</code> branch and ensure tests pass
locally.</p>
</article></div>
    </section>


    </main>
</div>
    
</body>
</html>





