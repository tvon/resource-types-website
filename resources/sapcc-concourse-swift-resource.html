<!DOCTYPE html>
<html lang="en">
<head>
    
    <title>Duty Free - OpenStack Swift</title>

    <link rel="stylesheet" type="text/css" href="/dutyfree/static/style.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
</head>
<body>
<div class="container detail-page">
    <div class="logo-area">
        <div class="title">
            <h1>CONCOURSE DUTY FREE</h1>
        </div>
    </div>


    <div class="search">
         
    </div>

    <nav class="sidebar">
         
    </nav>

    <main class="content">

        <div class="breadcrumb">
        
        
            
                    <span class="breadcrumb-link"><a href="/dutyfree">All Resources</a></span>
                
        
            
                    <span>OpenStack Swift</span>
            
        
        </div>

        
    <section class="top-area">
        <h2>OpenStack Swift</h2>
        <div>
            <a target="_blank" href="https://github.com/sapcc/concourse-swift-resource">
                <img src="/dutyfree/static/GitHub-Mark-120px-plus.png" alt="Resource Source on Github"
                     class="github-icon-detail"
                     title="Resource Source on Github">
            </a>
            <a href="https://github.com/sapcc" target="_blank" class="author">sapcc</a>
        </div>
    </section>
    <section class="middle-area">
        <img class="github-last-commit"
             alt="GitHub last commit"
             src="https://img.shields.io/github/last-commit/sapcc/concourse-swift-resource.svg?labelColor=757474&color=C4C4C4&style=flat-square">
        <div class="description">
            <h3>Description</h3>
            <p class="desc">Versions objects in a Swift container, by pattern-matching filenames to identify version numbers. This resource is heavily inspired by the official S3 resource.</p>
        </div>
        
    </section>
    <section id="github-readme">
        <h3>Read Me</h3>
        <div id="readme" class="instapaper_body md" data-path="README.md"><article class="markdown-body entry-content p-5" itemprop="text"><p><a href="https://travis-ci.org/sapcc/concourse-swift-resource" rel="nofollow"><img src="https://camo.githubusercontent.com/b1c46317ed97c78cdc76db467bc890318603bec1/68747470733a2f2f7472617669732d63692e6f72672f73617063632f636f6e636f757273652d73776966742d7265736f757263652e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/sapcc/concourse-swift-resource.png?branch=master" style="max-width:100%;"></a></p>
<h1><a id="user-content-concourse-resource-for-openstack-swift" class="anchor" aria-hidden="true" href="#concourse-resource-for-openstack-swift"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Concourse resource for OpenStack Swift</h1>
<p>Versions objects in a Swift container, by pattern-matching filenames to identify
version numbers.</p>
<p>This resource is heavily inspired by the <a href="https://gthub.com/concourse/s3-resource" rel="nofollow">official S3 resource</a></p>
<h2><a id="user-content-adding-to-your-pipeline" class="anchor" aria-hidden="true" href="#adding-to-your-pipeline"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding to your pipeline</h2>
<p>To use the Swift Resource, you must declare it in your pipeline as a resource type:</p>
<pre><code>resource_types:
- name: swift
  type: docker-image
  source:
    repository: databus23/concourse-swift-resource
</code></pre>
<h2><a id="user-content-alternativly-add-resource-with-bosh-to-concourse" class="anchor" aria-hidden="true" href="#alternativly-add-resource-with-bosh-to-concourse"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Alternativly add resource with BOSH to Concourse</h2>
<p>In your bosh deployment manifest, add to the following to the <code>groundcrew.additional_resource_types</code>:</p>
<div class="highlight highlight-source-yaml"><pre>- <span class="pl-ent">image</span>: <span class="pl-s">docker:///databus23/concourse-swift-resource</span>
  <span class="pl-ent">type</span>: <span class="pl-s">swift</span></pre></div>
<h2><a id="user-content-source-configuration" class="anchor" aria-hidden="true" href="#source-configuration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Source Configuration</h2>
<ul>
<li>
<p><code>auth_url</code>: <em>Required.</em> The url for authentication (Keystone)</p>
</li>
<li>
<p><code>username</code>: <em>Required.</em> The username to use when accessing the
container.</p>
</li>
<li>
<p><code>api_key</code>: <em>Required.</em> The password of the given user.</p>
</li>
<li>
<p><code>domain</code>: <em>Required.</em> The domain of the user</p>
</li>
<li>
<p><code>tenant_id</code>: <em>Required.</em> The project id</p>
</li>
<li>
<p><code>container</code>: <em>Required</em> The swift container</p>
</li>
<li>
<p><code>regex</code>: <em>Required</em> The pattern to match filenames against. The first
grouped match is used to extract the version. The extracted version
needs to be parseable by <a href="https://github.com/hashicorp/go-version">go-version</a></p>
</li>
<li>
<p><code>disable_tls_verify</code>: Disable certificate verification for https connections to keystone and swift. Default: false</p>
</li>
</ul>
<h2><a id="user-content-behaviour" class="anchor" aria-hidden="true" href="#behaviour"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Behaviour</h2>
<h3><a id="user-content-check-extract-versions-from-the-container" class="anchor" aria-hidden="true" href="#check-extract-versions-from-the-container"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>check</code>: Extract versions from the container.</h3>
<p>Objects will be found via the pattern configured by <code>regex</code>. The versions
will be used to order them (using <a href="http://semver.org/" rel="nofollow">semver</a>). Each
object's filename is the resulting version.</p>
<h3><a id="user-content-in-fetch-an-object-from-the-container" class="anchor" aria-hidden="true" href="#in-fetch-an-object-from-the-container"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>in</code>: Fetch an object from the container.</h3>
<p>Places the following files in the destination:</p>
<ul>
<li><code>$objectname</code>: The object fetched from the container.</li>
<li><code>filename</code>: Contains the filename of the fetched object ($objectname).</li>
<li><code>version</code>: Contains the version extracted from the file name.</li>
</ul>
<h4><a id="user-content-parameters" class="anchor" aria-hidden="true" href="#parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parameters</h4>
<p><em>None.</em></p>
<h3><a id="user-content-out-upload-an-object-to-the-container" class="anchor" aria-hidden="true" href="#out-upload-an-object-to-the-container"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>out</code>: Upload an object to the container.</h3>
<p>Given a path specified by <code>from</code>, upload it to the Swift container. The path must identify a single file. The filename must conform to the <code>regex</code> specified in the resource.</p>
<h4><a id="user-content-parameters-1" class="anchor" aria-hidden="true" href="#parameters-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parameters</h4>
<ul>
<li>
<p><code>from</code>: <em>Required.</em> A regexp specifying the file to upload.</p>
</li>
<li>
<p><code>segment_container</code> : <em>Optional</em> Name of the container where segments should be stored. Segments will be created for files larger than 1 GB. (Default: ${container}_segments)</p>
</li>
<li>
<p><code>segment_size</code>: <em>Optional</em> Size of segments (Default: 1073741824 Byte) (1 GB)</p>
</li>
<li>
<p><code>delete_after</code>: <em>Optional</em> Instruct Swift to schedule automatic deletion of the Object in <code>n</code>seconds (Default: disabled). Useful to define Object retention policies.</p>
</li>
</ul>
<h2><a id="user-content-example-configuration" class="anchor" aria-hidden="true" href="#example-configuration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example Configuration</h2>
<h3><a id="user-content-resource" class="anchor" aria-hidden="true" href="#resource"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resource</h3>
<div class="highlight highlight-source-yaml"><pre>- <span class="pl-ent">name</span>: <span class="pl-s">myapp</span>
  <span class="pl-ent">type</span>: <span class="pl-s">swift</span>
  <span class="pl-ent">source</span>:
    <span class="pl-ent">username</span>: <span class="pl-s">user</span>
    <span class="pl-ent">api_key</span>: <span class="pl-s">secret</span>
    <span class="pl-ent">auth_url</span>: <span class="pl-s">http://somewhere.at.keystone:5000/v3</span>
    <span class="pl-ent">domain</span>: <span class="pl-s">somedomain</span>
    <span class="pl-ent">container</span>: <span class="pl-s">mycontainer</span>
    <span class="pl-ent">regex</span>: <span class="pl-s">myapp-([.0-9])+\.tgz</span>
    <span class="pl-ent">tenant_id</span>: <span class="pl-s">tenantid</span></pre></div>
<h3><a id="user-content-plan" class="anchor" aria-hidden="true" href="#plan"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Plan</h3>
<div class="highlight highlight-source-yaml"><pre>- <span class="pl-ent">get</span>: <span class="pl-s">myapp</span></pre></div>
<div class="highlight highlight-source-yaml"><pre>- <span class="pl-ent">put</span>: <span class="pl-s">myapp</span>
  <span class="pl-ent">params</span>:
    <span class="pl-ent">from</span>: <span class="pl-s">a-task/build/path/file-(.*).tgz</span>
    <span class="pl-ent">segment_container</span>: <span class="pl-s">mysegmentcontainer</span>
    <span class="pl-ent">segment_size</span>: <span class="pl-c1">1073741824</span>
    <span class="pl-ent">delete_after</span>: <span class="pl-c1">3600</span>
</pre></div>
</article></div>
    </section>


    </main>
</div>
    
</body>
</html>





